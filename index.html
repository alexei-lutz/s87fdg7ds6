<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <meta name="description" content="A simple jQuery Hex grid Widget, implemented using SVG, for prototyping hex-grid based games." />
	<script src="https://code.jquery.com/jquery-2.1.4.min.js" ></script>
	<script src="https://cdnjs.cloudflare.com/ajax/libs/svg.js/2.6.6/svg.min.js"></script>
	<script src="svg.path.js"></script>
	<script src="svg.pathmorphing.js"></script>
	<script src="script.js" ></script>
	<style type="text/css">
		#hex-grid {
			width: 100vw;
			height: 100vh;
		}
		.hexfield {
		  fill: transparent;
		  stroke: yellowgreen;
		  stroke-width: 1;
		}
		.hexfield:focus {
		  outline:none;
		}
		.hexfield:hover {
		  fill: green;
		}
		.hexfield:active {
		  fill: red;
		  outline: none;
		}
		.hexfield.clicked{
		  fill: black;
		}
	</style>
  </head>
<body>

	<div id="container"> </div>

<script>
	<!-- main initialisation -->
	var rebuild = function () {
		var
			radius = $(window).width() / 20, 
		    columns = 10, 
		    rows = 6, 
		    cssClass = 'hexfield';
		$('#container').empty().hexGridWidget(radius, columns, rows, cssClass).on('hexclick', function (e) { 
		     $('#logger').text('clicked [' + e.column + ',' + e.row + '] hex with center at [' + e.center.x + ',' + e.center.y + '] px');
		});
		$('#container .hexfield').click(function () {
		    this.classList.toggle('clicked');
		});

		const draw = SVG('hex-grid')

		function pointsToCoordinates (points) {
              let coordinates = []
              points.forEach(function (point) {
                  let arr = point.split(',')
                  const x = Number(arr[0])
                  const y = Number(arr[1])
                  coordinates.push({x: x, y: y})
              })

              return coordinates
          }

		function getNumCoordsOfTheElement (elem) {
	        const pointsArr = elem.attr('points').split(" ")
	        const numCoords = pointsToCoordinates(pointsArr)
	        return numCoords
	    }

	    function getHexInnerCoordinates (elem) {
	        const coords = getNumCoordsOfTheElement(elem)

	        let xCoords = []
	        let yCoords = []

	        coords.forEach(function (item) {
	            xCoords.push(item.x)
	            yCoords.push(item.y)
	        })

	        const xRight = Math.max.apply(null, xCoords)
	        const xLeft = Math.min.apply(null, xCoords)

	        const yTop = Math.min.apply(null, yCoords)
	        const yBottom = Math.max.apply(null, yCoords)

	        const xCenter = xLeft + ((xRight - xLeft) / 2)
	        const yCenter = yTop + ((yBottom - yTop) / 2)

	        return {
	            xCenter: xCenter, yCenter: yCenter,
	            xLeft: xLeft, xRight: xRight,
	            yTop: yTop, yBottom: yBottom
	        }
	    }


		function fillWithContent (object) {
			draw
				.text(object.text)
				.fill('#000')
				.attr({
					x: getHexInnerCoordinates(object.el).xCenter,
					y: getHexInnerCoordinates(object.el).yCenter
				})
		}

		const object1 = {

		  	el: $('#container [hex-row=2][hex-column=2]'),
		  	text: 'lorem ipsum'

		}

		fillWithContent(object1)

	};
	$('#rebuild').click(rebuild);
	rebuild();
</script>
  </body>
</html>